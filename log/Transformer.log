nohup: ignoring input
Reading lines...
Read 232736 sentence pairs
Trimmed to 22907 sentence pairs
Counting words...
Counted words:
fra 7019
eng 4638
/root/anaconda3/envs/assignment/lib/python3.12/site-packages/torch/nn/modules/transformer.py:379: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.self_attn.batch_first was not True(use batch_first for better inference performance)
  warnings.warn(
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Currently logged in as: bayishli to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: WARNING Using a boolean value for 'reinit' is deprecated. Use 'return_previous' or 'finish_previous' instead.
wandb: Tracking run with wandb version 0.19.9
wandb: Run data is saved locally in /workspace/SHLi/Assignment2/wandb/run-20250418_181405-9bklw1vd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run Transformer
wandb: ⭐️ View project at https://wandb.ai/bayishli/Assignment%202
wandb: 🚀 View run at https://wandb.ai/bayishli/Assignment%202/runs/9bklw1vd
Epoch: 0/20
0m 43s (- 59m 24s) (5000 1%) 3.2312
1m 25s (- 57m 4s) (10000 2%) 2.8431
2m 6s (- 55m 47s) (15000 3%) 2.7169
2m 46s (- 54m 28s) (20000 4%) 2.6425
Epoch: 1/20
3m 28s (- 53m 44s) (25000 6%) 2.5194
4m 12s (- 53m 42s) (30000 7%) 2.4302
4m 56s (- 53m 20s) (35000 8%) 2.3838
5m 40s (- 52m 48s) (40000 9%) 2.3658
Epoch: 2/20
6m 25s (- 52m 25s) (45000 10%) 2.2980
7m 9s (- 51m 49s) (50000 12%) 2.2592
7m 52s (- 51m 11s) (55000 13%) 2.1959
8m 37s (- 50m 41s) (60000 14%) 2.2641
Epoch: 3/20
9m 21s (- 50m 0s) (65000 15%) 2.2457
10m 5s (- 49m 19s) (70000 16%) 2.1782
10m 48s (- 48m 37s) (75000 18%) 2.1471
11m 34s (- 48m 4s) (80000 19%) 2.1810
Epoch: 4/20
12m 17s (- 47m 21s) (85000 20%) 2.1927
13m 1s (- 46m 39s) (90000 21%) 2.1460
13m 46s (- 46m 1s) (95000 23%) 2.1132
14m 30s (- 45m 19s) (100000 24%) 2.0908
Epoch: 5/20
15m 14s (- 44m 36s) (105000 25%) 2.0974
15m 59s (- 43m 57s) (110000 26%) 2.0512
16m 43s (- 43m 13s) (115000 27%) 2.0499
17m 27s (- 42m 30s) (120000 29%) 2.0817
Epoch: 6/20
18m 12s (- 41m 50s) (125000 30%) 2.0532
18m 56s (- 41m 8s) (130000 31%) 1.9928
19m 40s (- 40m 24s) (135000 32%) 1.9438
20m 26s (- 39m 44s) (140000 33%) 2.0338
Epoch: 7/20
21m 10s (- 39m 1s) (145000 35%) 2.0625
21m 54s (- 38m 18s) (150000 36%) 2.0720
22m 38s (- 37m 36s) (155000 37%) 2.0047
23m 22s (- 36m 50s) (160000 38%) 1.9963
Epoch: 8/20
24m 5s (- 36m 7s) (165000 40%) 2.0106
24m 49s (- 35m 23s) (170000 41%) 1.9891
25m 35s (- 34m 41s) (175000 42%) 1.9545
26m 18s (- 33m 57s) (180000 43%) 1.9435
27m 2s (- 33m 13s) (185000 44%) 1.9949
Epoch: 9/20
27m 48s (- 32m 32s) (190000 46%) 1.9864
28m 32s (- 31m 48s) (195000 47%) 1.9411
29m 16s (- 31m 4s) (200000 48%) 1.9337
30m 1s (- 30m 22s) (205000 49%) 1.9423
Epoch: 10/20
30m 45s (- 29m 37s) (210000 50%) 2.0102
31m 29s (- 28m 54s) (215000 52%) 1.9571
32m 14s (- 28m 11s) (220000 53%) 1.9557
32m 58s (- 27m 27s) (225000 54%) 2.1319
Epoch: 11/20
33m 42s (- 26m 43s) (230000 55%) 2.1582
34m 27s (- 26m 0s) (235000 56%) 2.1505
35m 12s (- 25m 16s) (240000 58%) 2.1832
35m 55s (- 24m 31s) (245000 59%) 2.2440
Epoch: 12/20
36m 40s (- 23m 48s) (250000 60%) 2.2547
37m 24s (- 23m 4s) (255000 61%) 2.1960
38m 8s (- 22m 20s) (260000 63%) 2.1978
38m 53s (- 21m 37s) (265000 64%) 2.1728
Epoch: 13/20
39m 37s (- 20m 53s) (270000 65%) 2.1735
40m 21s (- 20m 9s) (275000 66%) 2.0981
41m 6s (- 19m 25s) (280000 67%) 2.1219
41m 50s (- 18m 41s) (285000 69%) 2.1632
Epoch: 14/20
42m 34s (- 17m 57s) (290000 70%) 2.1911
43m 18s (- 17m 13s) (295000 71%) 2.1543
44m 4s (- 16m 29s) (300000 72%) 2.1742
44m 47s (- 15m 45s) (305000 73%) 2.1435
Epoch: 15/20
45m 32s (- 15m 1s) (310000 75%) 2.1462
46m 17s (- 14m 18s) (315000 76%) 2.2030
47m 1s (- 13m 33s) (320000 77%) 2.1777
47m 44s (- 12m 49s) (325000 78%) 2.1761
Epoch: 16/20
48m 29s (- 12m 5s) (330000 80%) 2.1629
49m 13s (- 11m 21s) (335000 81%) 2.1733
49m 57s (- 10m 37s) (340000 82%) 2.1285
50m 42s (- 9m 53s) (345000 83%) 2.1908
51m 26s (- 9m 9s) (350000 84%) 2.1613
Epoch: 17/20
52m 10s (- 8m 25s) (355000 86%) 2.1663
52m 55s (- 7m 41s) (360000 87%) 2.1825
53m 39s (- 6m 57s) (365000 88%) 2.2584
54m 22s (- 6m 13s) (370000 89%) 2.2378
Epoch: 18/20
55m 7s (- 5m 29s) (375000 90%) 2.2615
55m 51s (- 4m 45s) (380000 92%) 2.2102
56m 35s (- 4m 0s) (385000 93%) 2.1905
57m 18s (- 3m 16s) (390000 94%) 2.1701
Epoch: 19/20
58m 3s (- 2m 32s) (395000 95%) 2.1692
58m 47s (- 1m 48s) (400000 97%) 2.1653
59m 31s (- 1m 4s) (405000 98%) 2.1721
60m 17s (- 0m 20s) (410000 99%) 2.1308
> j ai pris une mauvaise decision .
= i made a bad decision .
< i made a a a mistake . <EOS>

> je suis certaine de son honnetete .
= i am sure of his honesty .
< i m a member of you . <EOS>

> je n ai pas peur des femmes .
= i m not scared of women .
< i m not afraid of you . <EOS>

> vous n etes pas tres ordonnees .
= you re not very tidy .
< you re not very good . <EOS>

> je suis fascine par les chats .
= i m fascinated by cats .
< i m on my way . <EOS>

> j essaie de vous parler .
= i m trying to talk to you .
< i m trying to your . <EOS>

> vous etes vraiment bonne .
= you really are good .
< you re really gorgeous . <EOS>

> je suis honore d etre ici .
= i m honored to be here .
< i m a new student . <EOS>

> tu desobeis aux ordres .
= you re disobeying orders .
< you re making progress . <EOS>

> je fredonne .
= i m humming .
< i m going . <EOS>

  0%|          | 0/2291 [00:00<?, ?it/s]  1%|▏         | 30/2291 [00:00<00:07, 296.56it/s]  3%|▎         | 62/2291 [00:00<00:07, 307.92it/s]  4%|▍         | 96/2291 [00:00<00:06, 317.44it/s]  6%|▌         | 130/2291 [00:00<00:06, 325.14it/s]  7%|▋         | 165/2291 [00:00<00:06, 331.00it/s]  9%|▊         | 199/2291 [00:00<00:06, 332.04it/s] 10%|█         | 233/2291 [00:00<00:06, 329.46it/s] 12%|█▏        | 270/2291 [00:00<00:05, 341.20it/s] 13%|█▎        | 305/2291 [00:00<00:05, 339.18it/s] 15%|█▍        | 339/2291 [00:01<00:05, 337.47it/s] 16%|█▋        | 374/2291 [00:01<00:05, 340.01it/s] 18%|█▊        | 409/2291 [00:01<00:05, 335.19it/s] 19%|█▉        | 444/2291 [00:01<00:05, 338.50it/s] 21%|██        | 478/2291 [00:01<00:05, 334.68it/s] 22%|██▏       | 512/2291 [00:01<00:05, 333.79it/s] 24%|██▍       | 546/2291 [00:01<00:05, 332.87it/s] 25%|██▌       | 583/2291 [00:01<00:04, 341.83it/s] 27%|██▋       | 618/2291 [00:01<00:04, 338.95it/s] 28%|██▊       | 652/2291 [00:01<00:04, 338.82it/s] 30%|██▉       | 686/2291 [00:02<00:04, 335.76it/s] 31%|███▏      | 720/2291 [00:02<00:04, 334.73it/s] 33%|███▎      | 755/2291 [00:02<00:04, 338.09it/s] 34%|███▍      | 790/2291 [00:02<00:04, 341.08it/s] 36%|███▌      | 826/2291 [00:02<00:04, 343.48it/s] 38%|███▊      | 861/2291 [00:02<00:04, 344.89it/s] 39%|███▉      | 896/2291 [00:02<00:04, 341.46it/s] 41%|████      | 931/2291 [00:02<00:03, 342.64it/s] 42%|████▏     | 966/2291 [00:02<00:03, 344.49it/s] 44%|████▎     | 1001/2291 [00:02<00:03, 341.64it/s] 45%|████▌     | 1036/2291 [00:03<00:03, 342.61it/s] 47%|████▋     | 1071/2291 [00:03<00:03, 341.49it/s] 48%|████▊     | 1106/2291 [00:03<00:03, 337.97it/s] 50%|████▉     | 1140/2291 [00:03<00:03, 332.70it/s] 51%|█████     | 1174/2291 [00:03<00:03, 330.12it/s] 53%|█████▎    | 1209/2291 [00:03<00:03, 335.60it/s] 54%|█████▍    | 1243/2291 [00:03<00:03, 334.43it/s] 56%|█████▌    | 1277/2291 [00:05<00:14, 67.92it/s]  57%|█████▋    | 1311/2291 [00:05<00:11, 89.02it/s] 59%|█████▉    | 1346/2291 [00:05<00:08, 115.05it/s] 60%|██████    | 1381/2291 [00:05<00:06, 144.05it/s] 62%|██████▏   | 1414/2291 [00:05<00:05, 171.98it/s] 63%|██████▎   | 1447/2291 [00:05<00:04, 199.50it/s] 65%|██████▍   | 1481/2291 [00:05<00:03, 227.68it/s] 66%|██████▌   | 1514/2291 [00:05<00:03, 248.27it/s] 68%|██████▊   | 1547/2291 [00:05<00:02, 265.74it/s] 69%|██████▉   | 1580/2291 [00:06<00:02, 280.54it/s] 70%|███████   | 1613/2291 [00:06<00:02, 292.98it/s] 72%|███████▏  | 1648/2291 [00:06<00:02, 306.44it/s] 73%|███████▎  | 1682/2291 [00:06<00:01, 313.80it/s] 75%|███████▍  | 1715/2291 [00:06<00:01, 317.99it/s] 76%|███████▋  | 1750/2291 [00:06<00:01, 326.15it/s] 78%|███████▊  | 1784/2291 [00:06<00:01, 329.28it/s] 79%|███████▉  | 1818/2291 [00:06<00:01, 325.40it/s] 81%|████████  | 1853/2291 [00:06<00:01, 330.95it/s] 82%|████████▏ | 1890/2291 [00:06<00:01, 339.65it/s] 84%|████████▍ | 1925/2291 [00:07<00:01, 336.42it/s] 86%|████████▌ | 1959/2291 [00:07<00:00, 337.38it/s] 87%|████████▋ | 1993/2291 [00:07<00:00, 334.26it/s] 88%|████████▊ | 2027/2291 [00:07<00:00, 333.44it/s] 90%|████████▉ | 2061/2291 [00:07<00:00, 331.57it/s] 91%|█████████▏| 2095/2291 [00:07<00:00, 333.88it/s] 93%|█████████▎| 2129/2291 [00:07<00:00, 331.58it/s] 94%|█████████▍| 2164/2291 [00:07<00:00, 335.99it/s] 96%|█████████▌| 2198/2291 [00:07<00:00, 328.55it/s] 98%|█████████▊| 2234/2291 [00:08<00:00, 335.46it/s] 99%|█████████▉| 2268/2291 [00:08<00:00, 330.40it/s]100%|██████████| 2291/2291 [00:08<00:00, 279.83it/s]
=== Evaluation score - Rouge score ===
Rouge1 fmeasure:	 0.4191945195198059
Rouge1 precision:	 0.4039781391620636
Rouge1 recall:  	 0.447641521692276
Rouge2 fmeasure:	 0.2449071705341339
Rouge2 precision:	 0.2334025651216507
Rouge2 recall:  	 0.26816272735595703
=====================================
[1;34mwandb[0m: 
[1;34mwandb[0m: 🚀 View run [33mTransformer[0m at: [34mhttps://wandb.ai/bayishli/Assignment%202/runs/9bklw1vd[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250418_181405-9bklw1vd/logs[0m
